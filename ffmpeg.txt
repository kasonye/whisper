要将视频转录为文字，您需要先从视频中提取音频，然后再使用 Whisper 进行转录。让我为您提供完整的步骤。

  方法一：使用 FFmpeg（推荐）

  1. 安装 FFmpeg

  Windows 安装方式：

  选项 A - 使用 Chocolatey（推荐）：
  # 如果已安装 Chocolatey
  choco install ffmpeg

  # 如果没有 Chocolatey，先安装：
  # 以管理员身份运行 PowerShell，执行：
  Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

  选项 B - 手动安装：
  1. 访问 https://www.gyan.dev/ffmpeg/builds/
  2. 下载 "ffmpeg-release-essentials.zip"
  3. 解压到 C:\ffmpeg
  4. 将 C:\ffmpeg\bin 添加到系统环境变量 PATH

  2. 验证 FFmpeg 安装

  ffmpeg -version

  3. 从视频提取音频

  提取为 WAV 格式（推荐，质量最好）：
  ffmpeg -i video.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 audio.wav

  提取为 MP3 格式（文件更小）：
  ffmpeg -i video.mp4 -vn -acodec libmp3lame -q:a 2 audio.mp3

  参数说明：
  - -i video.mp4：输入视频文件
  - -vn：不处理视频流（只提取音频）
  - -acodec pcm_s16le：音频编码格式（WAV）
  - -ar 16000：采样率 16kHz（Whisper 推荐）
  - -ac 1：单声道（减小文件大小）
  - -q:a 2：音频质量（MP3，2 表示高质量）

  4. 使用 Whisper 转录

  whisper-cli audio.wav -o transcript.txt --verbose

  方法二：一步完成（推荐）

  创建一个批处理脚本或直接使用管道：

  Windows PowerShell 脚本：

  创建一个名为 transcribe-video.ps1 的文件：

  # transcribe-video.ps1
  param(
      [Parameter(Mandatory=$true)]
      [string]$VideoPath,

      [Parameter(Mandatory=$false)]
      [string]$OutputPath = ""
  )

  # 生成临时音频文件名
  $tempAudio = [System.IO.Path]::GetTempFileName() + ".wav"

  Write-Host "Step 1: Extracting audio from video..." -ForegroundColor Green
  ffmpeg -i $VideoPath -vn -acodec pcm_s16le -ar 16000 -ac 1 $tempAudio -y

  if ($LASTEXITCODE -ne 0) {
      Write-Host "Error: Failed to extract audio" -ForegroundColor Red
      exit 1
  }

  Write-Host "Step 2: Transcribing audio..." -ForegroundColor Green
  if ($OutputPath -eq "") {
      whisper-cli $tempAudio --verbose
  } else {
      whisper-cli $tempAudio -o $OutputPath --verbose
  }

  # 清理临时文件
  Remove-Item $tempAudio -ErrorAction SilentlyContinue

  Write-Host "Done!" -ForegroundColor Green

  使用方法：
  # 输出到终端
  .\transcribe-video.ps1 -VideoPath "video.mp4"

  # 保存到文件
  .\transcribe-video.ps1 -VideoPath "video.mp4" -OutputPath "transcript.txt"

  方法三：简单的命令行方式

  直接在命令行执行（两步）：

  # 步骤 1：提取音频
  ffmpeg -i your_video.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp_audio.wav

  # 步骤 2：转录
  whisper-cli temp_audio.wav -o transcript.txt --verbose

  # 步骤 3：删除临时文件（可选）
  del temp_audio.wav

  支持的视频格式

  FFmpeg 支持几乎所有视频格式：
  - MP4 (.mp4)
  - AVI (.avi)
  - MKV (.mkv)
  - MOV (.mov)
  - FLV (.flv)
  - WMV (.wmv)
  - WEBM (.webm)
  - 等等

  完整示例

  假设您有一个名为 interview.mp4 的视频：

  # 提取音频
  ffmpeg -i interview.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 interview_audio.wav

  # 转录并保存
  whisper-cli interview_audio.wav -o interview_transcript.txt --verbose

  # 查看结果
  type interview_transcript.txt

  批量处理多个视频

  PowerShell 批量处理：
  Get-ChildItem *.mp4 | ForEach-Object {
      $audioFile = "$($_.BaseName)_audio.wav"
      $transcriptFile = "$($_.BaseName)_transcript.txt"

      Write-Host "Processing: $($_.Name)"
      ffmpeg -i $_.FullName -vn -acodec pcm_s16le -ar 16000 -ac 1 $audioFile -y
      whisper-cli $audioFile -o $transcriptFile --verbose
      Remove-Item $audioFile
  }

  注意事项

  1. 磁盘空间：WAV 文件较大，1 小时视频约 100-200MB 音频
  2. 处理时间：提取音频很快（几秒），转录时间取决于是否使用 GPU
  3. 音频质量：使用 16kHz 采样率足够语音识别，无需更高质量